<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>User Data Categories</title>
    ~[wc:commonscripts] 
    <link href="/images/css/screen.css" rel="stylesheet" media="screen">
    <link href="/images/css/print.css" rel="stylesheet" media="print">
    <style>
      .kwe_ud_btn{padding:6px 10px;border:1px solid #aaa;background:#f7f7f7;border-radius:4px;cursor:pointer;text-decoration:none;display:inline-block}
      .kwe_ud_btn_danger{border-color:#c00}
      .kwe_ud_btn_disabled{opacity:.45;pointer-events:none}
      table{border-collapse:collapse;width:80%}
      th,td{border:1px solid #ddd;padding:8px}
      th{background:#f0f0f0;text-align:left}
      .kwe_ud_right{text-align:right}
      .kwe_ud_hint{color:#666;font-size:12px}
    </style>
</head>
<body>
    ~[wc:admin_header_css] 
    <a href=" " target="_top">Start Page</a> &gt; File Service Tools
    ~[wc:admin_navigation_css]

<h1>User Data Categories</h1>

<p class="kwe_ud_hint">
  Categories define "types" of user data (MAP Scores, Club Experience, Skillsets).  
  You can only delete (or edit fields) when no user records exist for that category.
</p>

<p>
  <a class="kwe_ud_btn" href="categories-edit.html?id=-1">+ New Category</a>
</p>

<table id="catTable">
  <thead>
    <tr>
      <th>Name</th>
      <th>Code</th>
      <th>Active</th>
      <th>Sort</th>
      <th>Records</th>
      <th class="kwe_ud_right">Actions</th>
    </tr>
  </thead>
  <tbody>
    ~[tlist_sql;
      SELECT
        c.NAME name,
        c.CODE code,
        c.IS_ACTIVE is_active,
        c.SORT_ORDER sort_order,
        (SELECT COUNT(*) FROM U_UD_RECORD r WHERE r.CATEGORY_ID = c.ID) rec_count,
        c.ID id
      FROM U_UD_CATEGORY c
      ORDER BY NVL(c.SORT_ORDER, 9999), UPPER(c.NAME)
    ]
    <tr>
      <td>~(name)</td>
      <td>~(code)</td>
      <td>~(is_active)</td>
      <td>~(sort_order)</td>
      <td>~(rec_count)</td>
      <td class="kwe_ud_right">
        <a class="kwe_ud_btn" href="categories-edit.html?id=~(id)">Edit</a>
        <a class="kwe_ud_btn" href="fielddefs.html?catid=~(id)">Fields</a>
        ~[if.~(rec_count;l)=0]
          <a class="kwe_ud_btn kwe_ud_btn_danger" href="categories-delete.html?id=~(id)">Delete</a>
        [else]
          <span class="kwe_ud_btn kwe_ud_btn_danger kwe_ud_btn_disabled" title="Locked: category has records">Delete</span>
        [/if]
      </td>
    </tr>
    [/tlist_sql]
  </tbody>
</table>


</body>
</html>
