<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Delete Category</title>
    ~[wc:commonscripts] 
    <link href="/images/css/screen.css" rel="stylesheet" media="screen">
    <link href="/images/css/print.css" rel="stylesheet" media="print">
    <style>
      .kwe_ud_btn{padding:6px 10px;border:1px solid #aaa;background:#f7f7f7;border-radius:4px;cursor:pointer}
      .kwe_ud_danger{border-color:#c00}
      .kwe_ud_box{padding:12px;border:1px solid #ddd;background:#fafafa}
    </style>
</head>
<body>
    ~[wc:admin_header_css] 
    <a href="/" target="_top">Start Page</a> &gt; File Service Tools
    ~[wc:admin_navigation_css]

<h1>Delete Category</h1>

~[tlist_sql;
  SELECT
    c.ID id,
    c.NAME name,
    (SELECT COUNT(*) FROM U_UD_RECORD r WHERE r.CATEGORY_ID = c.ID) rec_count,
    CASE
      WHEN (SELECT COUNT(*) FROM U_UD_RECORD r WHERE r.CATEGORY_ID = c.ID) > 0
      THEN '<p style="color:#c00"><b>Cannot delete.</b> This category already has records.</p><p><a class="kwe_ud_btn" href="categories.html">Back</a></p>'
      ELSE '<form action="categories.html" method="POST"><p style="color:#c00"><b>This will permanently delete the category.</b></p><input type="hidden" name="DD-U_UD_CATEGORY.ID:' || TO_CHAR(c.ID) || '" value="1"><input type="hidden" name="ac" value="prim"><button class="kwe_ud_btn kwe_ud_danger" type="submit">Delete</button> <a class="kwe_ud_btn" href="categories.html">Cancel</a></form>'
    END delete_content
  FROM U_UD_CATEGORY c
  WHERE c.ID = ~(gpv.id)
]
  <div class="kwe_ud_box">
    <p>Category: <b>~(name)</b></p>
    <p>Record count: <b>~(rec_count)</b></p>

    ~(delete_content)
  </div>
[/tlist_sql]
</body>
</html>
